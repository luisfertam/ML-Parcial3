
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>0. Importaciones &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'libro';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
  
    <p class="title logo__title">My Jupyter Book</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    0. Importaciones
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/libro.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>0. Importaciones</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">0. Importaciones</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#satiscaccion-clientes">1. Satiscaccion clientes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">1.1. EDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-y-metricas">1.2. Entrenamiento y métricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion-csv-de-prueba">1.3. prediccion CSV de prueba</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fisioterapia">2. Fisioterapia</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga">2.1. Carga</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#particiones">2.2. Particiones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.3. Entrenamiento y métricas</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="importaciones">
<h1>0. Importaciones<a class="headerlink" href="#importaciones" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">joblib</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">roc_curve</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">normal_ad</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>

<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>

<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="satiscaccion-clientes">
<h1>1. Satiscaccion clientes<a class="headerlink" href="#satiscaccion-clientes" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;train.csv&quot;</span><span class="p">)</span>
<span class="n">dfTest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;test.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="eda">
<h2>1.1. EDA<a class="headerlink" href="#eda" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 1], dtype=int64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>var3</th>
      <th>var15</th>
      <th>imp_ent_var16_ult1</th>
      <th>imp_op_var39_comer_ult1</th>
      <th>imp_op_var39_comer_ult3</th>
      <th>imp_op_var40_comer_ult1</th>
      <th>imp_op_var40_comer_ult3</th>
      <th>imp_op_var40_efect_ult1</th>
      <th>imp_op_var40_efect_ult3</th>
      <th>...</th>
      <th>saldo_medio_var33_hace2</th>
      <th>saldo_medio_var33_hace3</th>
      <th>saldo_medio_var33_ult1</th>
      <th>saldo_medio_var33_ult3</th>
      <th>saldo_medio_var44_hace2</th>
      <th>saldo_medio_var44_hace3</th>
      <th>saldo_medio_var44_ult1</th>
      <th>saldo_medio_var44_ult3</th>
      <th>var38</th>
      <th>TARGET</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>...</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>7.602000e+04</td>
      <td>76020.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>75964.050723</td>
      <td>-1523.199277</td>
      <td>33.212865</td>
      <td>86.208265</td>
      <td>72.363067</td>
      <td>119.529632</td>
      <td>3.559130</td>
      <td>6.472698</td>
      <td>0.412946</td>
      <td>0.567352</td>
      <td>...</td>
      <td>7.935824</td>
      <td>1.365146</td>
      <td>12.215580</td>
      <td>8.784074</td>
      <td>31.505324</td>
      <td>1.858575</td>
      <td>76.026165</td>
      <td>56.614351</td>
      <td>1.172358e+05</td>
      <td>0.039569</td>
    </tr>
    <tr>
      <th>std</th>
      <td>43781.947379</td>
      <td>39033.462364</td>
      <td>12.956486</td>
      <td>1614.757313</td>
      <td>339.315831</td>
      <td>546.266294</td>
      <td>93.155749</td>
      <td>153.737066</td>
      <td>30.604864</td>
      <td>36.513513</td>
      <td>...</td>
      <td>455.887218</td>
      <td>113.959637</td>
      <td>783.207399</td>
      <td>538.439211</td>
      <td>2013.125393</td>
      <td>147.786584</td>
      <td>4040.337842</td>
      <td>2852.579397</td>
      <td>1.826646e+05</td>
      <td>0.194945</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>-999999.000000</td>
      <td>5.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.163750e+03</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>38104.750000</td>
      <td>2.000000</td>
      <td>23.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.787061e+04</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>76043.000000</td>
      <td>2.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.064092e+05</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>113748.750000</td>
      <td>2.000000</td>
      <td>40.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.187563e+05</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>151838.000000</td>
      <td>238.000000</td>
      <td>105.000000</td>
      <td>210000.000000</td>
      <td>12888.030000</td>
      <td>21024.810000</td>
      <td>8237.820000</td>
      <td>11073.570000</td>
      <td>6600.000000</td>
      <td>6600.000000</td>
      <td>...</td>
      <td>50003.880000</td>
      <td>20385.720000</td>
      <td>138831.630000</td>
      <td>91778.730000</td>
      <td>438329.220000</td>
      <td>24650.010000</td>
      <td>681462.900000</td>
      <td>397884.300000</td>
      <td>2.203474e+07</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 371 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 76020 entries, 0 to 76019
Columns: 371 entries, ID to TARGET
dtypes: float64(111), int64(260)
memory usage: 215.2 MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1">#No hay datos faltantes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ID                         0
var3                       0
var15                      0
imp_ent_var16_ult1         0
imp_op_var39_comer_ult1    0
                          ..
saldo_medio_var44_hace3    0
saldo_medio_var44_ult1     0
saldo_medio_var44_ult3     0
var38                      0
TARGET                     0
Length: 371, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bars</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución de la variable target&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()):</span>
    <span class="n">bars</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0a44483f08092fc8f3587485f191e79ea984641b33e5558cc4cf6f1c96315b03.png" src="_images/0a44483f08092fc8f3587485f191e79ea984641b33e5558cc4cf6f1c96315b03.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variables_seleccionadas</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>  <span class="c1"># Seleccionar 10 variables numéricas</span>
<span class="n">df_</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">variables_seleccionadas</span><span class="p">]</span>
<span class="n">df_</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b7919c62829e9cf22ae9a980a4c75c2ba7a6996eef7a5fe55c061692dbd4ceb0.png" src="_images/b7919c62829e9cf22ae9a980a4c75c2ba7a6996eef7a5fe55c061692dbd4ceb0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">variables_seleccionadas</span><span class="p">:</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">column</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Boxplot: </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3dd54ea3bfb16977e544da73853fe0f64818f84b6e424b6af9633925b5e3c79f.png" src="_images/3dd54ea3bfb16977e544da73853fe0f64818f84b6e424b6af9633925b5e3c79f.png" />
<img alt="_images/02a14ae14a612c02bfdcd10461eb7223e55bc5019e9d5bfedf5fb23d1440e3ea.png" src="_images/02a14ae14a612c02bfdcd10461eb7223e55bc5019e9d5bfedf5fb23d1440e3ea.png" />
<img alt="_images/7a9f0eaae708d9ef9fe4cba1cf449721ea74e3209f1ae5d96411e7c471040475.png" src="_images/7a9f0eaae708d9ef9fe4cba1cf449721ea74e3209f1ae5d96411e7c471040475.png" />
<img alt="_images/1515403f75191c0d215d96ac2faacf555b3801dbe991aa2ab227a67919c65a9a.png" src="_images/1515403f75191c0d215d96ac2faacf555b3801dbe991aa2ab227a67919c65a9a.png" />
<img alt="_images/e776981b79e6727320508a7f7925fb10227ebf0bc94caaee9f7a471840f3e5f1.png" src="_images/e776981b79e6727320508a7f7925fb10227ebf0bc94caaee9f7a471840f3e5f1.png" />
<img alt="_images/ad820e686ef03915c16714dae0a28f89de92cc34ec0d9cb6108d4c9940a0d5e6.png" src="_images/ad820e686ef03915c16714dae0a28f89de92cc34ec0d9cb6108d4c9940a0d5e6.png" />
<img alt="_images/17c0c88e7b0826446be557835379d8b4713933ae9172ab688c95544b22420883.png" src="_images/17c0c88e7b0826446be557835379d8b4713933ae9172ab688c95544b22420883.png" />
<img alt="_images/22619101d3785773de8afe2f5e843c85c33dbd5c42e40ff1c1c94a3190d60abf.png" src="_images/22619101d3785773de8afe2f5e843c85c33dbd5c42e40ff1c1c94a3190d60abf.png" />
<img alt="_images/b64cf483e34346c278587f877ccb43726eab4eb67d9bcf1f18c1a6dbc49ae6a5.png" src="_images/b64cf483e34346c278587f877ccb43726eab4eb67d9bcf1f18c1a6dbc49ae6a5.png" />
<img alt="_images/9395c6f657cf4e6c6f541a20941502d0ffd3bd117aeeec54690c70b68e86df1d.png" src="_images/9395c6f657cf4e6c6f541a20941502d0ffd3bd117aeeec54690c70b68e86df1d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lleva mucho tiempo</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column_x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables_seleccionadas</span><span class="p">[:</span><span class="mi">5</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">column_y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables_seleccionadas</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">]):</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">column_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">column_y</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">column_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">column_y</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">column_x</span><span class="si">}</span><span class="s2"> --- </span><span class="si">{</span><span class="n">column_y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cfd23606e199ceb2cc97b71b18238e2da243e38c8bf61a3ef4c706ab74dbacf3.png" src="_images/cfd23606e199ceb2cc97b71b18238e2da243e38c8bf61a3ef4c706ab74dbacf3.png" />
<img alt="_images/a978f077f23915ade418b465ab44453a57a636b604ad1adce5f4d7b039db0012.png" src="_images/a978f077f23915ade418b465ab44453a57a636b604ad1adce5f4d7b039db0012.png" />
<img alt="_images/a28b0bed01cf1579ab6bab05b7b5ad5b302cce931e8f9f4b8734ff8f8279de35.png" src="_images/a28b0bed01cf1579ab6bab05b7b5ad5b302cce931e8f9f4b8734ff8f8279de35.png" />
<img alt="_images/d01bfcff36bd34286f7b975a93a83dd74ceaa12aa7eaf4214c249c8b7c3dfaa9.png" src="_images/d01bfcff36bd34286f7b975a93a83dd74ceaa12aa7eaf4214c249c8b7c3dfaa9.png" />
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">column_y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables_seleccionadas</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">]):</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">column_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">column_y</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">5</span>     <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">column_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">column_y</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">column_x</span><span class="si">}</span><span class="s2"> --- </span><span class="si">{</span><span class="n">column_y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\seaborn\regression.py:775,</span> in <span class="ni">regplot</span><span class="nt">(data, x, y, x_estimator, x_bins, x_ci, scatter, fit_reg, ci, n_boot, units, seed, order, logistic, lowess, robust, logx, x_partial, y_partial, truncate, dropna, x_jitter, y_jitter, label, color, marker, scatter_kws, line_kws, ax)</span>
<span class="g g-Whitespace">    </span><span class="mi">773</span> <span class="n">scatter_kws</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
<span class="g g-Whitespace">    </span><span class="mi">774</span> <span class="n">line_kws</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">line_kws</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">line_kws</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">775</span> <span class="n">plotter</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="p">,</span> <span class="n">line_kws</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">776</span> <span class="k">return</span> <span class="n">ax</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\seaborn\regression.py:384,</span> in <span class="ni">_RegressionPlotter.plot</span><span class="nt">(self, ax, scatter_kws, line_kws)</span>
<span class="g g-Whitespace">    </span><span class="mi">381</span>     <span class="bp">self</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">383</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_reg</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">384</span>     <span class="bp">self</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">line_kws</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">386</span> <span class="c1"># Label the axes</span>
<span class="g g-Whitespace">    </span><span class="mi">387</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">):</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\seaborn\regression.py:429,</span> in <span class="ni">_RegressionPlotter.lineplot</span><span class="nt">(self, ax, kws)</span>
<span class="g g-Whitespace">    </span><span class="mi">427</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Draw the model.&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">428</span> <span class="c1"># Fit the regression model</span>
<span class="ne">--&gt; </span><span class="mi">429</span> <span class="n">grid</span><span class="p">,</span> <span class="n">yhat</span><span class="p">,</span> <span class="n">err_bands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_regression</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">430</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">432</span> <span class="c1"># Get set default aesthetics</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\seaborn\regression.py:229,</span> in <span class="ni">_RegressionPlotter.fit_regression</span><span class="nt">(self, ax, x_range, grid)</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span>     <span class="n">yhat</span><span class="p">,</span> <span class="n">yhat_boots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_logx</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">229</span>     <span class="n">yhat</span><span class="p">,</span> <span class="n">yhat_boots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_fast</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span> <span class="c1"># Compute the confidence interval at each grid point</span>
<span class="g g-Whitespace">    </span><span class="mi">232</span> <span class="k">if</span> <span class="n">ci</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\seaborn\regression.py:250,</span> in <span class="ni">_RegressionPlotter.fit_fast</span><span class="nt">(self, grid)</span>
<span class="g g-Whitespace">    </span><span class="mi">247</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ci</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span>     <span class="k">return</span> <span class="n">yhat</span><span class="p">,</span> <span class="kc">None</span>
<span class="ne">--&gt; </span><span class="mi">250</span> <span class="n">beta_boots</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">251</span>                             <span class="n">func</span><span class="o">=</span><span class="n">reg_func</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">252</span>                             <span class="n">n_boot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_boot</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">253</span>                             <span class="n">units</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">254</span>                             <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="g g-Whitespace">    </span><span class="mi">255</span> <span class="n">yhat_boots</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">beta_boots</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="g g-Whitespace">    </span><span class="mi">256</span> <span class="k">return</span> <span class="n">yhat</span><span class="p">,</span> <span class="n">yhat_boots</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\seaborn\algorithms.py:99,</span> in <span class="ni">bootstrap</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_boot</span><span class="p">)):</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span>     <span class="n">resampler</span> <span class="o">=</span> <span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span>  <span class="c1"># intp is indexing dtype</span>
<span class="ne">---&gt; </span><span class="mi">99</span>     <span class="n">sample</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">resampler</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>     <span class="n">boot_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">sample</span><span class="p">,</span> <span class="o">**</span><span class="n">func_kwargs</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">boot_dist</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
<img alt="_images/a44c88733b38ad96f9bd10a3b98f9fc5fc6223c1823c46d48bae983db50398fc.png" src="_images/a44c88733b38ad96f9bd10a3b98f9fc5fc6223c1823c46d48bae983db50398fc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="n">variables_seleccionadas</span><span class="p">]</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">variables_seleccionadas</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calcular_vif</span><span class="p">(</span><span class="n">dataframe</span><span class="p">):</span>
    <span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;feature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">vif_data</span>

<span class="c1"># Iterar eliminación de variables con VIF &gt;= 10</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">vif_data</span> <span class="o">=</span> <span class="n">calcular_vif</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">variables_seleccionadas</span><span class="p">])</span>
    <span class="n">max_vif</span> <span class="o">=</span> <span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">max_vif</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">feature_to_remove</span> <span class="o">=</span> <span class="n">vif_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(),</span> <span class="s2">&quot;feature&quot;</span><span class="p">]</span>
        <span class="n">variables_seleccionadas</span> <span class="o">=</span> <span class="n">variables_seleccionadas</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">feature_to_remove</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="entrenamiento-y-metricas">
<h2>1.2. Entrenamiento y métricas<a class="headerlink" href="#entrenamiento-y-metricas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separación de datos en entrenamiento y prueba</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Escalamiento de datos</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Clasificasión Bayesiana&quot;</span><span class="p">:</span> <span class="n">GaussianNB</span><span class="p">(),</span>
    <span class="s2">&quot;K-NN&quot;</span><span class="p">:</span> <span class="n">KNeighborsClassifier</span><span class="p">(),</span>
    <span class="s2">&quot;L1-L2 Penalty Logistic Regression&quot;</span><span class="p">:</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">),</span>
    <span class="s2">&quot;Random Forest&quot;</span><span class="p">:</span> <span class="n">RandomForestClassifier</span><span class="p">(),</span>
    <span class="s2">&quot;XGBoost&quot;</span><span class="p">:</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">use_label_encoder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;logloss&#39;</span><span class="p">),</span>
    <span class="s2">&quot;SVM&quot;</span><span class="p">:</span> <span class="n">SVC</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">cont</span><span class="o">=</span><span class="mi">0</span>

<span class="k">for</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">modelo</span> <span class="ow">in</span> <span class="n">modelos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">modelo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;modeloP1-</span><span class="si">{</span><span class="n">nombre</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">)</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">modelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">y_prob</span> <span class="o">=</span> <span class="n">modelo</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
    
    <span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">)</span>
    
    <span class="n">resultados</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="n">nombre</span><span class="p">,</span>
        <span class="s2">&quot;Precision&quot;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span>
        <span class="s2">&quot;Recall&quot;</span><span class="p">:</span> <span class="n">recall</span><span class="p">,</span>
        <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
        <span class="s2">&quot;F1-Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
        <span class="s2">&quot;AUC&quot;</span><span class="p">:</span> <span class="n">auc</span>
    <span class="p">})</span>

    <span class="n">cont</span><span class="o">=</span><span class="n">cont</span><span class="o">+</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;modelo </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">/6&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla_resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
<span class="n">tabla_resultados</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="prediccion-csv-de-prueba">
<h2>1.3. prediccion CSV de prueba<a class="headerlink" href="#prediccion-csv-de-prueba" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nombreModelos</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Clasificasión Bayesiana&quot;</span><span class="p">,</span><span class="s2">&quot;K-NN&quot;</span><span class="p">,</span><span class="s2">&quot;L1-L2 Penalty Logistic Regression&quot;</span><span class="p">,</span><span class="s2">&quot;Random Forest&quot;</span><span class="p">,</span><span class="s2">&quot;XGBoost&quot;</span><span class="p">,</span><span class="s2">&quot;SVM&quot;</span><span class="p">]</span>
<span class="n">dfPredicciones</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">nombre</span> <span class="ow">in</span> <span class="n">nombreModelos</span><span class="p">:</span>
    <span class="n">modelo</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;modeloP1-</span><span class="si">{</span><span class="n">nombre</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">)</span>
    <span class="n">prediccion</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">modelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dfTest</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="n">dfPredicciones</span><span class="p">[</span><span class="n">nombre</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediccion</span>

    <span class="n">bars</span> <span class="o">=</span> <span class="n">prediccion</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribución predicciones </span><span class="si">{</span><span class="n">nombre</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prediccion</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()):</span>
        <span class="n">bars</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">dfPredicciones</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;P1-resultados.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;modeloP1-</span><span class="si">{</span><span class="n">nombre</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfPredicciones</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="fisioterapia">
<h1>2. Fisioterapia<a class="headerlink" href="#fisioterapia" title="Link to this heading">#</a></h1>
<section id="carga">
<h2>2.1. Carga<a class="headerlink" href="#carga" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">carpeta</span> <span class="o">=</span> <span class="s1">&#39;fisioterapia_dataset_regresion&#39;</span>
<span class="n">subjets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="s1">&#39;s4&#39;</span><span class="p">,</span> <span class="s1">&#39;s5&#39;</span><span class="p">]</span>
<span class="n">exercises</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;e1&#39;</span><span class="p">,</span> <span class="s1">&#39;e2&#39;</span><span class="p">,</span> <span class="s1">&#39;e3&#39;</span><span class="p">,</span> <span class="s1">&#39;e4&#39;</span><span class="p">,</span> <span class="s1">&#39;e5&#39;</span><span class="p">,</span> <span class="s1">&#39;e6&#39;</span><span class="p">,</span> <span class="s1">&#39;e7&#39;</span><span class="p">,</span> <span class="s1">&#39;e8&#39;</span><span class="p">]</span>
<span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;u1&#39;</span><span class="p">,</span> <span class="s1">&#39;u2&#39;</span><span class="p">,</span> <span class="s1">&#39;u3&#39;</span><span class="p">,</span> <span class="s1">&#39;u4&#39;</span><span class="p">,</span> <span class="s1">&#39;u5&#39;</span><span class="p">]</span>
<span class="n">nameTrain</span> <span class="o">=</span> <span class="s1">&#39;template_session.txt&#39;</span>
<span class="n">nameTest</span> <span class="o">=</span> <span class="s1">&#39;test.txt&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframesEntrenamiento</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dataframesPruebas</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">subjet</span> <span class="ow">in</span> <span class="n">subjets</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">exercise</span> <span class="ow">in</span> <span class="n">exercises</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">rutaTrain</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta</span><span class="p">,</span> <span class="n">subjet</span><span class="p">,</span> <span class="n">exercise</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">nameTrain</span><span class="p">)</span>
            <span class="n">rutaTest</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta</span><span class="p">,</span> <span class="n">subjet</span><span class="p">,</span> <span class="n">exercise</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">nameTest</span><span class="p">)</span>
            <span class="n">dataframesEntrenamiento</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">rutaTrain</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">))</span>
            <span class="n">dataframesPruebas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">rutaTest</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframesEntrenamiento</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time index</th>
      <th>acc_x</th>
      <th>acc_y</th>
      <th>acc_z</th>
      <th>gyr_x</th>
      <th>gyr_y</th>
      <th>gyr_z</th>
      <th>mag_x</th>
      <th>mag_y</th>
      <th>mag_z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>-9.665799</td>
      <td>-1.677241</td>
      <td>0.615063</td>
      <td>-0.014956</td>
      <td>0.004388</td>
      <td>0.010589</td>
      <td>0.587318</td>
      <td>0.455106</td>
      <td>-0.094949</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>-9.665806</td>
      <td>-1.684737</td>
      <td>0.622513</td>
      <td>0.000607</td>
      <td>-0.003094</td>
      <td>-0.007589</td>
      <td>0.587428</td>
      <td>0.455621</td>
      <td>-0.093364</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>-9.628410</td>
      <td>-1.699724</td>
      <td>0.585751</td>
      <td>0.006007</td>
      <td>0.000557</td>
      <td>-0.004879</td>
      <td>0.588389</td>
      <td>0.454722</td>
      <td>-0.094907</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>-9.628372</td>
      <td>-1.684836</td>
      <td>0.600733</td>
      <td>-0.003085</td>
      <td>-0.000281</td>
      <td>-0.000340</td>
      <td>0.588673</td>
      <td>0.455759</td>
      <td>-0.092664</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>-9.643291</td>
      <td>-1.639893</td>
      <td>0.585661</td>
      <td>-0.002932</td>
      <td>-0.006807</td>
      <td>-0.013043</td>
      <td>0.589193</td>
      <td>0.453927</td>
      <td>-0.093143</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2182</th>
      <td>2183</td>
      <td>-9.682711</td>
      <td>-1.706522</td>
      <td>0.350804</td>
      <td>-0.005728</td>
      <td>-0.003561</td>
      <td>-0.001633</td>
      <td>0.588366</td>
      <td>0.459061</td>
      <td>-0.064641</td>
    </tr>
    <tr>
      <th>2183</th>
      <td>2184</td>
      <td>-9.667724</td>
      <td>-1.691574</td>
      <td>0.328685</td>
      <td>-0.012997</td>
      <td>0.010897</td>
      <td>0.005710</td>
      <td>0.587457</td>
      <td>0.460252</td>
      <td>-0.065893</td>
    </tr>
    <tr>
      <th>2184</th>
      <td>2185</td>
      <td>-9.667731</td>
      <td>-1.684025</td>
      <td>0.306292</td>
      <td>-0.020050</td>
      <td>-0.000178</td>
      <td>-0.008818</td>
      <td>0.587153</td>
      <td>0.456937</td>
      <td>-0.065174</td>
    </tr>
    <tr>
      <th>2185</th>
      <td>2186</td>
      <td>-9.667744</td>
      <td>-1.699018</td>
      <td>0.321194</td>
      <td>-0.011103</td>
      <td>0.007172</td>
      <td>-0.001555</td>
      <td>0.586819</td>
      <td>0.457718</td>
      <td>-0.064133</td>
    </tr>
    <tr>
      <th>2186</th>
      <td>2187</td>
      <td>-9.667718</td>
      <td>-1.684078</td>
      <td>0.321234</td>
      <td>-0.014786</td>
      <td>0.007269</td>
      <td>0.003881</td>
      <td>0.587950</td>
      <td>0.457341</td>
      <td>-0.065156</td>
    </tr>
  </tbody>
</table>
<p>2187 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">indi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataframesEntrenamiento</span><span class="p">[</span><span class="n">indi</span><span class="p">][</span><span class="s1">&#39;acc_x&#39;</span><span class="p">],</span> <span class="n">dataframesEntrenamiento</span><span class="p">[</span><span class="n">indi</span><span class="p">][</span><span class="s1">&#39;acc_y&#39;</span><span class="p">],</span> <span class="n">dataframesEntrenamiento</span><span class="p">[</span><span class="n">indi</span><span class="p">][</span><span class="s1">&#39;acc_z&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Accelerometer&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Acc X&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Acc Y&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Acc Z&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Accelerometer Data&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataframesEntrenamiento</span><span class="p">[</span><span class="n">indi</span><span class="p">][</span><span class="s1">&#39;gyr_x&#39;</span><span class="p">],</span> <span class="n">dataframesEntrenamiento</span><span class="p">[</span><span class="n">indi</span><span class="p">][</span><span class="s1">&#39;gyr_y&#39;</span><span class="p">],</span> <span class="n">dataframesEntrenamiento</span><span class="p">[</span><span class="n">indi</span><span class="p">][</span><span class="s1">&#39;gyr_z&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gyroscope&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Gyr X&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Gyr Y&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Gyr Z&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gyroscope Data&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataframesEntrenamiento</span><span class="p">[</span><span class="n">indi</span><span class="p">][</span><span class="s1">&#39;mag_x&#39;</span><span class="p">],</span> <span class="n">dataframesEntrenamiento</span><span class="p">[</span><span class="n">indi</span><span class="p">][</span><span class="s1">&#39;mag_y&#39;</span><span class="p">],</span> <span class="n">dataframesEntrenamiento</span><span class="p">[</span><span class="n">indi</span><span class="p">][</span><span class="s1">&#39;mag_z&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Magnetometer&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Mag X&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mag Y&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Mag Z&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Magnetometer Data&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/34afb23dd2480b1740170676c9ea053f45134eddf3b7fc08e079bc7b8a7c9ec9.png" src="_images/34afb23dd2480b1740170676c9ea053f45134eddf3b7fc08e079bc7b8a7c9ec9.png" />
<img alt="_images/368f5abb5f5f7266761efa55d3eee206c9f4ba78c3dda8ea8286a3bc2e92fbee.png" src="_images/368f5abb5f5f7266761efa55d3eee206c9f4ba78c3dda8ea8286a3bc2e92fbee.png" />
<img alt="_images/582cf3e5743220306d4b0165c6609eb6ec882575c7a1f8c6eba359ade3b04885.png" src="_images/582cf3e5743220306d4b0165c6609eb6ec882575c7a1f8c6eba359ade3b04885.png" />
<img alt="_images/6ba93f8421a7e9e14517d703e7945070794e894ef2af859d5b4b8814af7a5703.png" src="_images/6ba93f8421a7e9e14517d703e7945070794e894ef2af859d5b4b8814af7a5703.png" />
<img alt="_images/134efaa33f60c4eb6672a3becaf0f4ca28c54276c5e51fdb46ef26d82dd4f45e.png" src="_images/134efaa33f60c4eb6672a3becaf0f4ca28c54276c5e51fdb46ef26d82dd4f45e.png" />
<img alt="_images/818405e903bd1390105465c4b5adcae1e730b6e725ce9b910224767354385e27.png" src="_images/818405e903bd1390105465c4b5adcae1e730b6e725ce9b910224767354385e27.png" />
<img alt="_images/c34be291e20410e0b95637bcef99128e65e86518af036997d83d32a22f34f5f8.png" src="_images/c34be291e20410e0b95637bcef99128e65e86518af036997d83d32a22f34f5f8.png" />
<img alt="_images/9319a935b74975180c268faeb95e47efae50ca09082253701791ac1f5fe4314b.png" src="_images/9319a935b74975180c268faeb95e47efae50ca09082253701791ac1f5fe4314b.png" />
<img alt="_images/811f05336104d10d911bfaa354cf7a9c744353b3bbbba855659c23b0c43e8647.png" src="_images/811f05336104d10d911bfaa354cf7a9c744353b3bbbba855659c23b0c43e8647.png" />
<img alt="_images/16450bb9a22571ea7b5b6350566cd24c5efdac14458027992c4195caa49a1028.png" src="_images/16450bb9a22571ea7b5b6350566cd24c5efdac14458027992c4195caa49a1028.png" />
</div>
</div>
</section>
<section id="particiones">
<h2>2.2. Particiones<a class="headerlink" href="#particiones" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ParticionTrainValTest</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">horizonte</span><span class="p">,</span> <span class="n">ventana</span><span class="p">):</span>

    <span class="n">tamTrain</span> <span class="o">=</span> <span class="mi">14</span>
    <span class="n">tamValid</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">tamTest</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">lendf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">Train</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Validation</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Test</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span> <span class="p">,</span>  <span class="n">lendf</span><span class="o">-</span><span class="n">ventana</span><span class="o">-</span><span class="n">horizonte</span> <span class="p">):</span>
        
        <span class="n">end</span> <span class="o">=</span> <span class="n">index</span><span class="o">+</span><span class="n">ventana</span>

        <span class="k">if</span> <span class="n">end</span><span class="o">+</span><span class="n">horizonte</span> <span class="o">&gt;</span> <span class="n">lendf</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="n">cont</span> <span class="o">&gt;</span> <span class="n">tamTrain</span><span class="o">+</span><span class="n">tamValid</span><span class="o">+</span><span class="n">tamTest</span><span class="p">:</span>
            <span class="n">cont</span><span class="o">=</span><span class="mi">0</span>

        <span class="k">if</span> <span class="n">cont</span> <span class="o">&lt;</span> <span class="n">tamTrain</span><span class="p">:</span>
            <span class="n">X_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span> <span class="p">:</span> <span class="n">end</span><span class="p">]</span>
            <span class="n">y_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">end</span> <span class="p">:</span> <span class="n">end</span><span class="o">+</span><span class="n">horizonte</span><span class="p">]</span>
            <span class="n">Train</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s2">&quot;X_train&quot;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">,</span>
                <span class="s2">&quot;y_train&quot;</span><span class="p">:</span> <span class="n">y_train</span>
            <span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cont</span> <span class="o">&lt;</span> <span class="n">tamTrain</span><span class="o">+</span><span class="n">tamValid</span><span class="p">:</span>
                <span class="n">X_val</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span> <span class="p">:</span> <span class="n">end</span><span class="p">]</span>
                <span class="n">y_val</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">end</span> <span class="p">:</span> <span class="n">end</span><span class="o">+</span><span class="n">horizonte</span><span class="p">]</span>
                <span class="n">Validation</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s2">&quot;X_test&quot;</span><span class="p">:</span> <span class="n">X_val</span><span class="p">,</span>
                    <span class="s2">&quot;y_test&quot;</span><span class="p">:</span> <span class="n">y_val</span>
                <span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cont</span> <span class="o">&lt;</span> <span class="n">tamTrain</span><span class="o">+</span><span class="n">tamValid</span><span class="o">+</span><span class="n">tamTest</span><span class="p">:</span>
                    <span class="n">X_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span> <span class="p">:</span> <span class="n">end</span><span class="p">]</span>
                    <span class="n">y_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">end</span> <span class="p">:</span> <span class="n">end</span><span class="o">+</span><span class="n">horizonte</span><span class="p">]</span>
                    <span class="n">Test</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s2">&quot;X_test&quot;</span><span class="p">:</span> <span class="n">X_test</span><span class="p">,</span>
                        <span class="s2">&quot;y_test&quot;</span><span class="p">:</span> <span class="n">y_test</span>
                    <span class="p">})</span>
        
        <span class="n">cont</span> <span class="o">+=</span> <span class="mi">1</span>


    <span class="k">return</span> <span class="n">Train</span> <span class="p">,</span> <span class="n">Validation</span> <span class="p">,</span> <span class="n">Test</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2>2.3. Entrenamiento y métricas<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;K-NN&quot;</span><span class="p">:</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
    <span class="s2">&quot;Linear Regression&quot;</span><span class="p">:</span> <span class="n">LinearRegression</span><span class="p">(),</span>
    <span class="s2">&quot;Ridge Regression&quot;</span><span class="p">:</span> <span class="n">Ridge</span><span class="p">(),</span>
    <span class="s2">&quot;Lasso Regression&quot;</span><span class="p">:</span> <span class="n">Lasso</span><span class="p">(),</span>
    <span class="s2">&quot;Random Forest Regressor&quot;</span><span class="p">:</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <span class="s2">&quot;XGBoost Regressor&quot;</span><span class="p">:</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <span class="s2">&quot;SVR&quot;</span><span class="p">:</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">metricas</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">:</span> <span class="n">r2</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">residuales</span><span class="p">(</span><span class="n">residuals</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Ljung-Box&quot;</span><span class="p">:</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">])[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;Jarque-Bera&quot;</span><span class="p">:</span> <span class="n">normal_ad</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">results</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">horizontes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">ventanas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">archivo</span> <span class="ow">in</span> <span class="n">dataframesEntrenamiento</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ventana</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
        <span class="n">entrenamientos</span><span class="p">,</span> <span class="n">validacions</span><span class="p">,</span> <span class="n">pruebas</span> <span class="o">=</span> <span class="n">ParticionTrainValTest</span><span class="p">(</span><span class="n">archivo</span><span class="p">,</span> <span class="n">horizontes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ventana</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">entrenamiento</span> <span class="ow">in</span> <span class="n">entrenamientos</span><span class="p">:</span>
            <span class="n">X_train</span> <span class="o">=</span> <span class="n">entrenamiento</span><span class="p">[</span><span class="s1">&#39;X_train&#39;</span><span class="p">]</span>
            <span class="n">y_train</span> <span class="o">=</span> <span class="n">entrenamiento</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">]</span>

            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pruebas</span><span class="p">[</span><span class="s1">&#39;X_test&#39;</span><span class="p">]</span>
            <span class="n">y_test</span> <span class="o">=</span> <span class="n">pruebas</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">]</span>
            
            <span class="k">for</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">modelo</span> <span class="ow">in</span> <span class="n">modelos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="n">modelo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">modelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

                <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>
                <span class="n">metrics_results</span> <span class="o">=</span> <span class="n">metricas</span><span class="p">()</span>
                <span class="n">residual_results</span> <span class="o">=</span> <span class="n">residuales</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>

                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="n">nombre</span><span class="p">,</span>
                    <span class="s2">&quot;τ&quot;</span><span class="p">:</span> <span class="n">ventana</span><span class="p">,</span>
                    <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">metrics_results</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">metrics_results</span><span class="p">[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;R²&quot;</span><span class="p">:</span> <span class="n">metrics_results</span><span class="p">[</span><span class="s2">&quot;R²&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;Ljung-Box p-value&quot;</span><span class="p">:</span> <span class="n">residual_results</span><span class="p">[</span><span class="s2">&quot;Ljung-Box p-value&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;Jarque-Bera p-value&quot;</span><span class="p">:</span> <span class="n">residual_results</span><span class="p">[</span><span class="s2">&quot;Jarque-Bera p-value&quot;</span><span class="p">]</span>
                <span class="p">})</span>

                <span class="k">break</span>
            <span class="k">break</span>
        <span class="k">break</span>
    <span class="k">break</span>

<span class="n">X_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">39</span><span class="p">],</span> <span class="n">line</span> <span class="mi">12</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">X_train</span> <span class="o">=</span> <span class="n">entrenamiento</span><span class="p">[</span><span class="s1">&#39;X_train&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">entrenamiento</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">]</span>
<span class="ne">---&gt; </span><span class="mi">12</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">pruebas</span><span class="p">[</span><span class="s1">&#39;X_test&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">pruebas</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="k">for</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">modelo</span> <span class="ow">in</span> <span class="n">modelos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="ne">TypeError</span>: list indices must be integers or slices, not str
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Entrenamiento y evaluación para cada modelo y cada horizonte temporal</span>
<span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">tau_values</span><span class="p">:</span>
    <span class="n">train</span><span class="p">,</span> <span class="n">validation</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">ParticionTrainValTest</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;magnetic_field&#39;</span><span class="p">],</span> <span class="n">tau</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Ajuste del modelo</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">train</span><span class="p">)</span>
        
        <span class="c1"># Predicciones en conjunto de validación y prueba</span>
        <span class="n">val_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">validation</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">test_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">validation</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">validation</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        
        <span class="c1"># Cálculo de métricas para validación y prueba</span>
        <span class="n">val_metrics</span> <span class="o">=</span> <span class="n">calculate_metrics</span><span class="p">(</span><span class="n">validation</span><span class="p">,</span> <span class="n">val_predictions</span><span class="p">)</span>
        <span class="n">test_metrics</span> <span class="o">=</span> <span class="n">calculate_metrics</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">test_predictions</span><span class="p">)</span>
        
        <span class="c1"># Análisis de residuos</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="n">test</span> <span class="o">-</span> <span class="n">test_predictions</span>
        <span class="n">residual_results</span> <span class="o">=</span> <span class="n">residual_analysis</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
        
        <span class="c1"># Guardar resultados</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">,</span>
            <span class="s2">&quot;τ&quot;</span><span class="p">:</span> <span class="n">tau</span><span class="p">,</span>
            <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">test_metrics</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">],</span>
            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">test_metrics</span><span class="p">[</span><span class="s2">&quot;RMSE&quot;</span><span class="p">],</span>
            <span class="s2">&quot;R²&quot;</span><span class="p">:</span> <span class="n">test_metrics</span><span class="p">[</span><span class="s2">&quot;R²&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Ljung-Box p-value&quot;</span><span class="p">:</span> <span class="n">residual_results</span><span class="p">[</span><span class="s2">&quot;Ljung-Box p-value&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Jarque-Bera p-value&quot;</span><span class="p">:</span> <span class="n">residual_results</span><span class="p">[</span><span class="s2">&quot;Jarque-Bera p-value&quot;</span><span class="p">]</span>
        <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">0. Importaciones</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#satiscaccion-clientes">1. Satiscaccion clientes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">1.1. EDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-y-metricas">1.2. Entrenamiento y métricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion-csv-de-prueba">1.3. prediccion CSV de prueba</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fisioterapia">2. Fisioterapia</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga">2.1. Carga</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#particiones">2.2. Particiones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.3. Entrenamiento y métricas</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>